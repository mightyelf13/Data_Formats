# Per director: number of movies and average duration in minutes.

PREFIX ex:   <http://example.org/vocabulary/>
PREFIX foaf: <http://xmlns.com/foaf/0.1/>

SELECT ?director
        (COUNT(?movie) AS ?movieCount)
        (ROUND(AVG(?minutes)) AS ?avgDuration)
WHERE {
    ?movie a ex:Movie ;
            ex:directedBy ?d ;
            ex:durationMinutes ?minutes .
    ?d a ex:Director ;
        foaf:name ?director .
}
GROUP BY ?director
ORDER BY DESC(?movieCount)